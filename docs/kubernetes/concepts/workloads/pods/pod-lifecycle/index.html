<!doctype html>
<html lang="zh" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.74.3" />

<META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">



<link rel="shortcut icon" href="/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/favicons/android-192x192.png" sizes="192x192">

<title>Pod Lifecycle | Website</title><meta property="og:title" content="Pod Lifecycle" />
<meta property="og:description" content="该页面将描述 Pod 的生命周期。
Pod phase Pod 的 status 定义在 PodStatus 对象中，其中有一个 phase 字段。
Pod 的运行阶段（phase）是 Pod 在其生命周期中的简单宏观概述。该阶段并不是对容器或 Pod 的综合汇总，也不是为了做为综合状态机。
Pod 运行阶段值的数量和含义是严格指定的。除了本文档中列举的内容外，不应该再假定 Pod 有其他的 phase 值。
下面是 phase 可能的值：
 挂起（Pending）：Pod 已被 Kubernetes 系统接受，但有一个或者多个容器镜像尚未创建。等待时间包括调度 Pod 的时间和通过网络下载镜像的时间，这可能需要花点时间。 运行中（Running）：该 Pod 已经绑定到了一个节点上，Pod 中所有的容器都已被创建。至少有一个容器正在运行，或者正处于启动或重启状态。 成功（Succeeded）：Pod 中的所有容器都被成功终止，并且不会再重启。 失败（Failed）：Pod 中的所有容器都已终止了，并且至少有一个容器是因为失败终止。也就是说，容器以非 0 状态退出或者被系统终止。 未知（Unknown）：因为某些原因无法取得 Pod 的状态，通常是因为与 Pod 所在主机通信失败。  Pod conditions Pod 有一个 PodStatus 对象，其中包含一个 PodCondition 数组。 PodCondition 数组的每个元素都有六个可能的字段：
 lastProbeTime 字段提供最后一次探测 Pod condition 的时间戳。 lastTransitionTime 字段提供 Pod 最后一次从一种状态过渡到另一种状态的时间戳。 message 字段是人类可读的消息，指示有关过渡的详细信息。 reason 字段是 condition 最后一次过渡的原因，该原因用唯一的、驼峰式的、一个词表示。 status 字段是一个字符串，可能的值有 &ldquo;True&rdquo;、&ldquo;False&rdquo; 和 &ldquo;Unknown&rdquo;。 type 字段是一个字符串，具有以下可能的值：  PodScheduled：已将Pod调度到一个节点； Ready：该 Pod 能够处理请求，应将其添加到所有匹配服务的负载均衡池中； Initialized：所有初始化容器已成功启动； ContainersReady：Pod 中的所有容器均已准备就绪。    容器探针 探针 是由 kubelet 对容器执行的定期诊断。要执行诊断，kubelet 调用由容器实现的 Handler。有三种类型的处理程序：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/docs/kubernetes/concepts/workloads/pods/pod-lifecycle/" />
<meta property="article:published_time" content="2020-07-23T16:43:26+08:00" />
<meta property="article:modified_time" content="2020-07-23T16:43:26+08:00" />
<meta itemprop="name" content="Pod Lifecycle">
<meta itemprop="description" content="该页面将描述 Pod 的生命周期。
Pod phase Pod 的 status 定义在 PodStatus 对象中，其中有一个 phase 字段。
Pod 的运行阶段（phase）是 Pod 在其生命周期中的简单宏观概述。该阶段并不是对容器或 Pod 的综合汇总，也不是为了做为综合状态机。
Pod 运行阶段值的数量和含义是严格指定的。除了本文档中列举的内容外，不应该再假定 Pod 有其他的 phase 值。
下面是 phase 可能的值：
 挂起（Pending）：Pod 已被 Kubernetes 系统接受，但有一个或者多个容器镜像尚未创建。等待时间包括调度 Pod 的时间和通过网络下载镜像的时间，这可能需要花点时间。 运行中（Running）：该 Pod 已经绑定到了一个节点上，Pod 中所有的容器都已被创建。至少有一个容器正在运行，或者正处于启动或重启状态。 成功（Succeeded）：Pod 中的所有容器都被成功终止，并且不会再重启。 失败（Failed）：Pod 中的所有容器都已终止了，并且至少有一个容器是因为失败终止。也就是说，容器以非 0 状态退出或者被系统终止。 未知（Unknown）：因为某些原因无法取得 Pod 的状态，通常是因为与 Pod 所在主机通信失败。  Pod conditions Pod 有一个 PodStatus 对象，其中包含一个 PodCondition 数组。 PodCondition 数组的每个元素都有六个可能的字段：
 lastProbeTime 字段提供最后一次探测 Pod condition 的时间戳。 lastTransitionTime 字段提供 Pod 最后一次从一种状态过渡到另一种状态的时间戳。 message 字段是人类可读的消息，指示有关过渡的详细信息。 reason 字段是 condition 最后一次过渡的原因，该原因用唯一的、驼峰式的、一个词表示。 status 字段是一个字符串，可能的值有 &ldquo;True&rdquo;、&ldquo;False&rdquo; 和 &ldquo;Unknown&rdquo;。 type 字段是一个字符串，具有以下可能的值：  PodScheduled：已将Pod调度到一个节点； Ready：该 Pod 能够处理请求，应将其添加到所有匹配服务的负载均衡池中； Initialized：所有初始化容器已成功启动； ContainersReady：Pod 中的所有容器均已准备就绪。    容器探针 探针 是由 kubelet 对容器执行的定期诊断。要执行诊断，kubelet 调用由容器实现的 Handler。有三种类型的处理程序：">
<meta itemprop="datePublished" content="2020-07-23T16:43:26+08:00" />
<meta itemprop="dateModified" content="2020-07-23T16:43:26+08:00" />
<meta itemprop="wordCount" content="553">



<meta itemprop="keywords" content="" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Pod Lifecycle"/>
<meta name="twitter:description" content="该页面将描述 Pod 的生命周期。
Pod phase Pod 的 status 定义在 PodStatus 对象中，其中有一个 phase 字段。
Pod 的运行阶段（phase）是 Pod 在其生命周期中的简单宏观概述。该阶段并不是对容器或 Pod 的综合汇总，也不是为了做为综合状态机。
Pod 运行阶段值的数量和含义是严格指定的。除了本文档中列举的内容外，不应该再假定 Pod 有其他的 phase 值。
下面是 phase 可能的值：
 挂起（Pending）：Pod 已被 Kubernetes 系统接受，但有一个或者多个容器镜像尚未创建。等待时间包括调度 Pod 的时间和通过网络下载镜像的时间，这可能需要花点时间。 运行中（Running）：该 Pod 已经绑定到了一个节点上，Pod 中所有的容器都已被创建。至少有一个容器正在运行，或者正处于启动或重启状态。 成功（Succeeded）：Pod 中的所有容器都被成功终止，并且不会再重启。 失败（Failed）：Pod 中的所有容器都已终止了，并且至少有一个容器是因为失败终止。也就是说，容器以非 0 状态退出或者被系统终止。 未知（Unknown）：因为某些原因无法取得 Pod 的状态，通常是因为与 Pod 所在主机通信失败。  Pod conditions Pod 有一个 PodStatus 对象，其中包含一个 PodCondition 数组。 PodCondition 数组的每个元素都有六个可能的字段：
 lastProbeTime 字段提供最后一次探测 Pod condition 的时间戳。 lastTransitionTime 字段提供 Pod 最后一次从一种状态过渡到另一种状态的时间戳。 message 字段是人类可读的消息，指示有关过渡的详细信息。 reason 字段是 condition 最后一次过渡的原因，该原因用唯一的、驼峰式的、一个词表示。 status 字段是一个字符串，可能的值有 &ldquo;True&rdquo;、&ldquo;False&rdquo; 和 &ldquo;Unknown&rdquo;。 type 字段是一个字符串，具有以下可能的值：  PodScheduled：已将Pod调度到一个节点； Ready：该 Pod 能够处理请求，应将其添加到所有匹配服务的负载均衡池中； Initialized：所有初始化容器已成功启动； ContainersReady：Pod 中的所有容器均已准备就绪。    容器探针 探针 是由 kubelet 对容器执行的定期诊断。要执行诊断，kubelet 调用由容器实现的 Handler。有三种类型的处理程序："/>





<link rel="preload" href="/scss/main.min.eb8a7e86ba897f8566b703828c07e55ead0b19fa8ee4f0182858858fdc11873b.css" as="style">
<link href="/scss/main.min.eb8a7e86ba897f8566b703828c07e55ead0b19fa8ee4f0182858858fdc11873b.css" rel="stylesheet" integrity="">


<script
  src="/js/jquery-3.5.1.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
  crossorigin="anonymous"></script>

<script
  src="/js/lunr-2.3.8.min.js"
  integrity="sha384-vRQ9bDyE0Wnu+lMfm57BlYLO0/XauFuKpVsZPs7KEDwYKktWi5+Kz3MP8++DFlRY"
  crossorigin="anonymous"></script>



  </head>
  <body class="td-page">
    <header>
      
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
  <a class="navbar-brand" href="/">
    <span class="navbar-logo">
      
    </span>
    <span class="font-weight-bold">Website</span>
  </a>
  <div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar">
    <ul class="navbar-nav mt-2 mt-lg-0">
      
      
        <li class="nav-item mr-4 mb-2 mb-lg-0">
          
          
          
          
          <a class="nav-link" href="/docs" >
            <span>Documentation</span>
          </a>
        </li>
      
        <li class="nav-item mr-4 mb-2 mb-lg-0">
          
          
          
          
          <a class="nav-link" href="/blog" >
            <span>Blogs</span>
          </a>
        </li>
      
        <li class="nav-item mr-4 mb-2 mb-lg-0">
          
          
          
          
          <a class="nav-link" href="/about" >
            <span>About</span>
          </a>
        </li>
      
      
      
      
        <li class="nav-item d-none d-lg-block">
          <a class="nav-link" href="https://github.com/luohu1/website" target="_blank">GitHub</a>
        </li>
      
    </ul>
  </div>
  <div class="navbar-nav d-none d-lg-block">


<input
  type="search"
  class="form-control td-search-input"
  placeholder="&#xf002; Search"
  aria-label="Search"
  autocomplete="off"
  
  data-offline-search-index-json-src="/offline-search-index.6c4dc6afa969caf14e1a2ac5591cc16dfb94f805f7ad272b5b9a087439410f130fd68c76708656184a2815a7b45938f70b38b713d732a1fd794c0a25e40ad0d1.json"
  data-offline-search-base-href="/"
  data-offlnie-search-max-results="10"
>

</div>
</nav>

    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
            




<div id="td-sidebar-menu" class="td-sidebar__inner">
  
  <form class="td-sidebar__search d-flex align-items-center">
    


<input
  type="search"
  class="form-control td-search-input"
  placeholder="&#xf002; Search"
  aria-label="Search"
  autocomplete="off"
  
  data-offline-search-index-json-src="/offline-search-index.6c4dc6afa969caf14e1a2ac5591cc16dfb94f805f7ad272b5b9a087439410f130fd68c76708656184a2815a7b45938f70b38b713d732a1fd794c0a25e40ad0d1.json"
  data-offline-search-base-href="/"
  data-offlnie-search-max-results="10"
>


    <button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type="button" data-toggle="collapse" data-target="#td-section-nav" aria-controls="td-docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    </button>
  </form>
  
  <nav class="collapse td-sidebar-nav" id="td-section-nav">
    
    






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/docs/" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section">Documentation</a>
  </li>
  <ul>
    <li class="collapse show" id="docs">
      
      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/docs/kubernetes/" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section">Kubernetes 文档</a>
  </li>
  <ul>
    <li class="collapse show" id="docskubernetes">
      
      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/docs/kubernetes/concepts/" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section">Concepts</a>
  </li>
  <ul>
    <li class="collapse show" id="docskubernetesconcepts">
      
      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/docs/kubernetes/concepts/overview/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Overview</a>
  </li>
  <ul>
    <li class="collapse " id="docskubernetesconceptsoverview">
      
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-docskubernetesconceptsoverviewkubenetes-components" href="/docs/kubernetes/concepts/overview/kubenetes-components/">Kubernetes Components</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-docskubernetesconceptsoverviewwhat-is-kubernetes" href="/docs/kubernetes/concepts/overview/what-is-kubernetes/">What is Kubernetes?</a>
      
      
    </li>
  </ul>
</ul>

      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/docs/kubernetes/concepts/cluster-architecture/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Cluster Architecture</a>
  </li>
  <ul>
    <li class="collapse " id="docskubernetesconceptscluster-architecture">
      
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-docskubernetesconceptscluster-architecturecontrollers" href="/docs/kubernetes/concepts/cluster-architecture/controllers/">Controllers</a>
      
      
    </li>
  </ul>
</ul>

      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/docs/kubernetes/concepts/workloads/" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section">Workloads</a>
  </li>
  <ul>
    <li class="collapse show" id="docskubernetesconceptsworkloads">
      
      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/docs/kubernetes/concepts/workloads/pods/" class="align-left pl-0 pr-2 active td-sidebar-link td-sidebar-link__section">Pods</a>
  </li>
  <ul>
    <li class="collapse show" id="docskubernetesconceptsworkloadspods">
      
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-docskubernetesconceptsworkloadspodspod-overview" href="/docs/kubernetes/concepts/workloads/pods/pod-overview/">Pod Overview</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-docskubernetesconceptsworkloadspodspods" href="/docs/kubernetes/concepts/workloads/pods/pods/">Pods</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page  active" id="m-docskubernetesconceptsworkloadspodspod-lifecycle" href="/docs/kubernetes/concepts/workloads/pods/pod-lifecycle/">Pod Lifecycle</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-docskubernetesconceptsworkloadspodsinit-containers" href="/docs/kubernetes/concepts/workloads/pods/init-containers/">Init 容器</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-docskubernetesconceptsworkloadspodspod-preset" href="/docs/kubernetes/concepts/workloads/pods/pod-preset/">Pod Preset</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-docskubernetesconceptsworkloadspodspod-topology-spread-constraints" href="/docs/kubernetes/concepts/workloads/pods/pod-topology-spread-constraints/">Pod 拓扑扩展约束</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-docskubernetesconceptsworkloadspodsdisruptions" href="/docs/kubernetes/concepts/workloads/pods/disruptions/">干扰（Disruptions）</a>
      
      
    </li>
  </ul>
</ul>

      
      
    </li>
  </ul>
</ul>

      
      
    </li>
  </ul>
</ul>

      
      
    </li>
  </ul>
</ul>

      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/docs/prometheus/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Prometheus</a>
  </li>
  <ul>
    <li class="collapse " id="docsprometheus">
      
      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/docs/prometheus/introduction/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Introduction</a>
  </li>
  <ul>
    <li class="collapse " id="docsprometheusintroduction">
      
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-docsprometheusintroductionoverview" href="/docs/prometheus/introduction/overview/">Overview</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-docsprometheusintroductionfirst-steps" href="/docs/prometheus/introduction/first-steps/">First Steps</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-docsprometheusintroductioncomparison-to-alternatives" href="/docs/prometheus/introduction/comparison-to-alternatives/">Comparison to Alternatives</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-docsprometheusintroductionfaq" href="/docs/prometheus/introduction/faq/">Frequently Asked Questions</a>
      
      
    </li>
  </ul>
</ul>

      
      
    </li>
  </ul>
</ul>

      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/docs/envoy/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Envoy</a>
  </li>
  <ul>
    <li class="collapse " id="docsenvoy">
      
      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/docs/envoy/introduction/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Introduction</a>
  </li>
  <ul>
    <li class="collapse " id="docsenvoyintroduction">
      
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-docsenvoyintroductionwhat-is-envoy" href="/docs/envoy/introduction/what-is-envoy/">What is Envoy</a>
      
      
    </li>
  </ul>
</ul>

      
      
    </li>
  </ul>
</ul>

      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/docs/jenkins/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Jenkins</a>
  </li>
  <ul>
    <li class="collapse " id="docsjenkins">
      
      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/docs/jenkins/user-handbook/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">User Handbook</a>
  </li>
  <ul>
    <li class="collapse " id="docsjenkinsuser-handbook">
      
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-docsjenkinsuser-handbookinstalling-jenkins" href="/docs/jenkins/user-handbook/installing-jenkins/">Installing Jenkins</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-docsjenkinsuser-handbookoverview" href="/docs/jenkins/user-handbook/overview/">User Handbook Overview</a>
      
      
    </li>
  </ul>
</ul>

      
      
    </li>
  </ul>
</ul>

      
      
    </li>
  </ul>
</ul>

  </nav>
</div>




          </div>
          <div class="d-none d-xl-block col-xl-2 td-toc d-print-none">
            






<div class="td-page-meta ml-2 pb-1 pt-2 mb-0">





<a href="https://github.com/luohu1/website/edit/master/content/zh/docs/kubernetes/concepts/workloads/pods/pod-lifecycle.md" target="_blank"><i class="fa fa-edit fa-fw"></i> Edit on GitHub</a>
<a href="https://github.com/luohu1/website/issues/new?title=Pod%20Lifecycle" target="_blank"><i class="fab fa-github fa-fw"></i> Report issues</a>

</div>






<nav id="TableOfContents">
  <ul>
    <li><a href="#pod-phase">Pod phase</a></li>
    <li><a href="#pod-conditions">Pod conditions</a></li>
    <li><a href="#容器探针">容器探针</a>
      <ul>
        <li><a href="#什么时候应该使用存活探针livenessprobe">什么时候应该使用存活探针（livenessProbe）？</a></li>
        <li><a href="#什么时候应该使用就绪探针readinessprobe">什么时候应该使用就绪探针（readinessProbe）？</a></li>
        <li><a href="#什么时候应该使用就绪探针startupprobe">什么时候应该使用就绪探针（startupProbe）？</a></li>
      </ul>
    </li>
    <li><a href="#pod-和容器状态">Pod 和容器状态</a></li>
    <li><a href="#容器状态">容器状态</a></li>
    <li><a href="#pod-就绪">Pod 就绪</a>
      <ul>
        <li><a href="#pod-就绪状态">Pod 就绪状态</a></li>
      </ul>
    </li>
    <li><a href="#重启策略">重启策略</a></li>
    <li><a href="#pod-的生命">Pod 的生命</a></li>
    <li><a href="#示例">示例</a>
      <ul>
        <li><a href="#高级-liveness-探针示例">高级 liveness 探针示例</a></li>
        <li><a href="#状态示例">状态示例</a></li>
      </ul>
    </li>
  </ul>
</nav>



          </div>
          <main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main">
            
  

            <nav aria-label="breadcrumb" class="d-none d-md-block d-print-none">
	<ol class="breadcrumb spb-1">
		



















<li class="breadcrumb-item" >
	<a href="/docs/">Documentation</a>
</li>




<li class="breadcrumb-item" >
	<a href="/docs/kubernetes/">Kubernetes 文档</a>
</li>




<li class="breadcrumb-item" >
	<a href="/docs/kubernetes/concepts/">Concepts</a>
</li>




<li class="breadcrumb-item" >
	<a href="/docs/kubernetes/concepts/workloads/">Workloads</a>
</li>




<li class="breadcrumb-item" >
	<a href="/docs/kubernetes/concepts/workloads/pods/">Pods</a>
</li>




<li class="breadcrumb-item active" aria-current="page">
	<a href="/docs/kubernetes/concepts/workloads/pods/pod-lifecycle/">Pod Lifecycle</a>
</li>

	</ol>
</nav	>

            
<div class="td-content">
	<h1>Pod Lifecycle</h1>
    
	       
	<p>该页面将描述 Pod 的生命周期。</p>
<h2 id="pod-phase">Pod phase</h2>
<p>Pod 的 <code>status</code> 定义在 <a href="https://kubernetes.io/docs/resources-reference/v1.7/#podstatus-v1-core">PodStatus</a> 对象中，其中有一个 <code>phase</code> 字段。</p>
<p>Pod 的运行阶段（phase）是 Pod 在其生命周期中的简单宏观概述。该阶段并不是对容器或 Pod 的综合汇总，也不是为了做为综合状态机。</p>
<p>Pod 运行阶段值的数量和含义是严格指定的。除了本文档中列举的内容外，不应该再假定 Pod 有其他的 <code>phase</code> 值。</p>
<p>下面是 <code>phase</code> 可能的值：</p>
<ul>
<li>挂起（Pending）：Pod 已被 Kubernetes 系统接受，但有一个或者多个容器镜像尚未创建。等待时间包括调度 Pod 的时间和通过网络下载镜像的时间，这可能需要花点时间。</li>
<li>运行中（Running）：该 Pod 已经绑定到了一个节点上，Pod 中所有的容器都已被创建。至少有一个容器正在运行，或者正处于启动或重启状态。</li>
<li>成功（Succeeded）：Pod 中的所有容器都被成功终止，并且不会再重启。</li>
<li>失败（Failed）：Pod 中的所有容器都已终止了，并且至少有一个容器是因为失败终止。也就是说，容器以非 0 状态退出或者被系统终止。</li>
<li>未知（Unknown）：因为某些原因无法取得 Pod 的状态，通常是因为与 Pod 所在主机通信失败。</li>
</ul>
<h2 id="pod-conditions">Pod conditions</h2>
<p>Pod 有一个 PodStatus 对象，其中包含一个 <a href="https://kubernetes.io/docs/resources-reference/v1.7/#podcondition-v1-core">PodCondition</a> 数组。 PodCondition 数组的每个元素都有六个可能的字段：</p>
<ul>
<li><code>lastProbeTime</code> 字段提供最后一次探测 Pod condition 的时间戳。</li>
<li><code>lastTransitionTime</code> 字段提供 Pod 最后一次从一种状态过渡到另一种状态的时间戳。</li>
<li><code>message</code> 字段是人类可读的消息，指示有关过渡的详细信息。</li>
<li><code>reason</code> 字段是 condition 最后一次过渡的原因，该原因用唯一的、驼峰式的、一个词表示。</li>
<li><code>status</code> 字段是一个字符串，可能的值有 &ldquo;<code>True</code>&rdquo;、&ldquo;<code>False</code>&rdquo; 和 &ldquo;<code>Unknown</code>&rdquo;。</li>
<li><code>type</code> 字段是一个字符串，具有以下可能的值：
<ul>
<li><code>PodScheduled</code>：已将Pod调度到一个节点；</li>
<li><code>Ready</code>：该 Pod 能够处理请求，应将其添加到所有匹配服务的负载均衡池中；</li>
<li><code>Initialized</code>：所有<a href="https://kubernetes.io/docs/concepts/workloads/pods/init-containers">初始化容器</a>已成功启动；</li>
<li><code>ContainersReady</code>：Pod 中的所有容器均已准备就绪。</li>
</ul>
</li>
</ul>
<h2 id="容器探针">容器探针</h2>
<p><a href="https://kubernetes.io/docs/resources-reference/v1.7/#probe-v1-core">探针</a> 是由 <a href="https://kubernetes.io/docs/admin/kubelet/">kubelet</a> 对容器执行的定期诊断。要执行诊断，kubelet 调用由容器实现的 <a href="https://godoc.org/k8s.io/kubernetes/pkg/api/v1#Handler">Handler</a>。有三种类型的处理程序：</p>
<ul>
<li><a href="https://kubernetes.io/docs/resources-reference/v1.7/#execaction-v1-core">ExecAction</a>：在容器内执行指定命令。如果命令退出时状态码为 0 则认为诊断成功。</li>
<li><a href="https://kubernetes.io/docs/resources-reference/v1.7/#tcpsocketaction-v1-core">TCPSocketAction</a>：对容器 IP 地址上指定的端口进行 TCP 检查。如果端口是开放的，则诊断被认为是成功的。</li>
<li><a href="https://kubernetes.io/docs/resources-reference/v1.7/#httpgetaction-v1-core">HTTPGetAction</a>：对容器的 IP 地址上指定的端口和路径执行 HTTP Get 请求。如果响应的状态码大于等于200 且小于 400，则诊断被认为是成功的。</li>
</ul>
<p>每次探测都将获得以下三种结果之一：</p>
<ul>
<li>成功（Success）：容器通过了诊断。</li>
<li>失败（Failure）：容器未通过诊断。</li>
<li>未知（Unknown）：诊断失败，因此不会采取任何行动。</li>
</ul>
<p>kubelet 可以选择对正在运行的 Container 进行三种探针的执行并对其做出反应：</p>
<ul>
<li><code>livenessProbe</code>：指示容器是否正在运行。如果存活探测失败，则 kubelet 会杀死容器，并且容器将受到其 <a href="https://kubernetes.io/docs/concepts/workloads/pods/pod-lifecycle/#restart-policy">重启策略</a> 的影响。如果容器不提供存活探针，则默认状态为 <code>Success</code>。</li>
<li><code>readinessProbe</code>：指示容器是否准备好服务请求。如果就绪探测失败，端点控制器将从与 Pod 匹配的所有 Service 的端点中删除该 Pod 的 IP 地址。初始延迟之前的就绪状态默认为 <code>Failure</code>。如果容器不提供就绪探针，则默认状态为 <code>Success</code>。</li>
<li><code>startupProbe</code>: 指示容器中的应用是否已经启动。如果提供了启动探测（startup probe），则禁用所有其他探测，直到它成功为止。如果启动探测失败，kubelet 将杀死容器，容器服从其重启策略进行重启。如果容器没有提供启动探测，则默认状态为成功<code>Success</code>。</li>
</ul>
<h3 id="什么时候应该使用存活探针livenessprobe">什么时候应该使用存活探针（livenessProbe）？</h3>
<p>**功能状态：**<code>Kubernetes v1.0 [stable]</code></p>
<p>如果容器中的进程能够在遇到问题或不健康的情况下能够自行崩溃，则不一定需要存活探针; kubelet 将根据 Pod 的<code>restartPolicy</code> 自动执行正确的操作。</p>
<p>如果您希望容器在探测失败时被杀死并重新启动，那么请指定一个存活探针，并指定<code>restartPolicy</code> 为 Always 或 OnFailure。</p>
<h3 id="什么时候应该使用就绪探针readinessprobe">什么时候应该使用就绪探针（readinessProbe）？</h3>
<p>**功能状态：**<code>Kubernetes v1.0 [stable]</code></p>
<p>如果您希望仅在探测成功时才开始向 Pod 发送流量，请指定就绪探针。在这种情况下，就绪探针可能与存活探针相同，但是 spec 中的就绪探针的存在意味着 Pod 将在没有接收到任何流量的情况下启动，并且只有在探针探测成功后才开始接收流量。如果您的容器需要在启动过程中加载大型数据、配置文件或迁移，请指定就绪探针。</p>
<p>如果您希望容器能够自行维护，您可以指定一个就绪探针，该探针检查与存活探针不同的端点。</p>
<p>请注意，如果您只是想在 Pod 被删除后能够排除请求，则不一定需要使用就绪探针；在删除 Pod 后，无论就绪探针是否存在，Pod 都会自动将自身置于未就绪状态。当等待 Pod 中的容器停止时，Pod 仍处于未完成状态。</p>
<h3 id="什么时候应该使用就绪探针startupprobe">什么时候应该使用就绪探针（startupProbe）？</h3>
<p>**功能状态：**<code>Kubernetes v1.16 [stable]</code></p>
<p>如果您的容器通常在超过 <code>initialDelaySeconds + failureThreshold × periodSeconds</code> 的时间内启动，则应指定一个启动探针，该探针检查与存活探针相同的端点。<code>periodSeconds</code> 的默认值为 30s。然后，应将其 <code>failureThreshold</code> 设置得足够高，以允许 Container 启动，而不更改存活探针的默认值。这有助于防止死锁。</p>
<h2 id="pod-和容器状态">Pod 和容器状态</h2>
<p>有关 Pod 容器状态的详细信息，请参阅 <a href="https://kubernetes.io/docs/resources-reference/v1.7/#podstatus-v1-core">PodStatus</a> 和 <a href="https://kubernetes.io/docs/resources-reference/v1.7/#containerstatus-v1-core">ContainerStatus</a>。请注意，报告的 Pod 状态信息取决于当前的 <a href="https://kubernetes.io/docs/resources-reference/v1.7/#containerstatus-v1-core">ContainerState</a>。</p>
<h2 id="容器状态">容器状态</h2>
<p>一旦 Pod 被调度器分配到节点后，kubelet 将开始使用容器运行时来创建容器。容器有三种可能的状态：Waiting、Running 和 Terminated。您可以使用 <code>kubectl describe pod [POD_NAME]</code> 来检查容器的状态。Pod 中每个容器的状态将会被显示。</p>
<ul>
<li>
<p><code>Waiting</code>: 容器的默认状态。如果容器未处于 Running 或 Terminated 状态，则处于 Waiting 状态。处于 Waiting 状态的容器仍会运行其所需的操作，例如拉取镜像，应用秘密等。关于该状态的消息和原因会伴随着该状态显示，以提供更多的信息。</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">...<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">State</span>:<span style="color:#bbb">          </span>Waiting<span style="color:#bbb">
</span><span style="color:#bbb">   </span><span style="color:#a2f;font-weight:bold">Reason</span>:<span style="color:#bbb">       </span>ErrImagePull<span style="color:#bbb">
</span><span style="color:#bbb"></span>...<span style="color:#bbb">
</span></code></pre></div></li>
<li>
<p><code>Running</code>: 表示容器正在执行，没有问题。 <code>postStart</code> 钩子（如果有）在容器进入 Running 状态之前执行。此状态还显示容器进入 Running 状态的时间。</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">...<span style="color:#bbb">
</span><span style="color:#bbb">   </span><span style="color:#a2f;font-weight:bold">State</span>:<span style="color:#bbb">          </span>Running<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">Started</span>:<span style="color:#bbb">      </span>Wed,<span style="color:#bbb"> </span><span style="color:#666">30</span><span style="color:#bbb"> </span>Jan<span style="color:#bbb"> </span><span style="color:#666">2019</span><span style="color:#bbb"> </span><span style="color:#666">16</span>:<span style="color:#666">46</span>:<span style="color:#666">38</span><span style="color:#bbb"> </span>+<span style="color:#666">0530</span><span style="color:#bbb">
</span><span style="color:#bbb"></span>...<span style="color:#bbb">
</span></code></pre></div></li>
<li>
<p><code>Terminated</code>: 表示容器已完成其执行并已停止运行。当容器成功完成执行或由于某种原因失败时，容器就会进入该容器。无论如何，都会显示原因和退出代码，以及容器的开始和结束时间。在容器进入 Terminated 之前，执行 <code>preStop</code> 挂钩（如果有）。</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">...<span style="color:#bbb">
</span><span style="color:#bbb">   </span><span style="color:#a2f;font-weight:bold">State</span>:<span style="color:#bbb">          </span>Terminated<span style="color:#bbb">
</span><span style="color:#bbb">     </span><span style="color:#a2f;font-weight:bold">Reason</span>:<span style="color:#bbb">       </span>Completed<span style="color:#bbb">
</span><span style="color:#bbb">     </span><span style="color:#a2f;font-weight:bold">Exit Code</span>:<span style="color:#bbb">    </span><span style="color:#666">0</span><span style="color:#bbb">
</span><span style="color:#bbb">     </span><span style="color:#a2f;font-weight:bold">Started</span>:<span style="color:#bbb">      </span>Wed,<span style="color:#bbb"> </span><span style="color:#666">30</span><span style="color:#bbb"> </span>Jan<span style="color:#bbb"> </span><span style="color:#666">2019</span><span style="color:#bbb"> </span><span style="color:#666">11</span>:<span style="color:#666">45</span>:<span style="color:#666">26</span><span style="color:#bbb"> </span>+<span style="color:#666">0530</span><span style="color:#bbb">
</span><span style="color:#bbb">     </span><span style="color:#a2f;font-weight:bold">Finished</span>:<span style="color:#bbb">     </span>Wed,<span style="color:#bbb"> </span><span style="color:#666">30</span><span style="color:#bbb"> </span>Jan<span style="color:#bbb"> </span><span style="color:#666">2019</span><span style="color:#bbb"> </span><span style="color:#666">11</span>:<span style="color:#666">45</span>:<span style="color:#666">26</span><span style="color:#bbb"> </span>+<span style="color:#666">0530</span><span style="color:#bbb">
</span><span style="color:#bbb"> </span>...<span style="color:#bbb">
</span></code></pre></div></li>
</ul>
<h2 id="pod-就绪">Pod 就绪</h2>
<p>**功能状态：**<code>Kubernetes v1.14 [stable]</code></p>
<p>您的应用程序可以向 PodStatus 注入额外的反馈或信号：<em>Pod readiness</em>。要使用此功能，请在 PodSpec 中设置 <code>readinessGates</code> 以指定 kubelet 为 Pod 就绪评估的其他条件列表。</p>
<p>Readiness gates 由 Pod 的 <code>status.condition</code> 字段的当前状态决定。如果 Kubernetes 在 Pod 的 <code>status.conditions</code> 字段中找不到这样的条件，则该条件的状态默认为“<code>False</code>”。</p>
<p>这是一个例子：</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#a2f;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>Pod<span style="color:#bbb">
</span><span style="color:#bbb"></span>...<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">spec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">readinessGates</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>- <span style="color:#a2f;font-weight:bold">conditionType</span>:<span style="color:#bbb"> </span><span style="color:#b44">&#34;www.example.com/feature-1&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">status</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">conditions</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>- <span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>Ready<span style="color:#bbb">                              </span><span style="color:#080;font-style:italic"># a built in PodCondition</span><span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">status</span>:<span style="color:#bbb"> </span><span style="color:#b44">&#34;False&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">lastProbeTime</span>:<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">null</span><span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">lastTransitionTime</span>:<span style="color:#bbb"> </span>2018-01-01T00:00:00Z<span style="color:#bbb">
</span><span style="color:#bbb">    </span>- <span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span><span style="color:#b44">&#34;www.example.com/feature-1&#34;</span><span style="color:#bbb">        </span><span style="color:#080;font-style:italic"># an extra PodCondition</span><span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">status</span>:<span style="color:#bbb"> </span><span style="color:#b44">&#34;False&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">lastProbeTime</span>:<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">null</span><span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">lastTransitionTime</span>:<span style="color:#bbb"> </span>2018-01-01T00:00:00Z<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">containerStatuses</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>- <span style="color:#a2f;font-weight:bold">containerID</span>:<span style="color:#bbb"> </span>docker://abcd...<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">ready</span>:<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">true</span><span style="color:#bbb">
</span><span style="color:#bbb"></span>...<span style="color:#bbb">
</span></code></pre></div><p>您添加的 Pod 条件必须具有符合Kubernetes <a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/#syntax-and-character-set">label key format</a> 的名称。</p>
<h3 id="pod-就绪状态">Pod 就绪状态</h3>
<p><code>kubectl patch</code> 命令不支持修补对象状态。要为 Pod 设置这些 <code>status.conditions</code>，应用程序和 <a href="https://kubernetes.io/docs/concepts/extend-kubernetes/operator/">操作员</a> 应使用 <code>PATCH</code> 操作。您可以使用 <a href="https://kubernetes.io/docs/reference/using-api/client-libraries/">Kubernetes client library</a> 编写代码，来为 Pod 就绪设置自定义 Pod 条件。</p>
<p>对于使用自定义条件的 Pod，仅当以下两个声明均适用时，该 Pod 才被评估为就绪：</p>
<ul>
<li>Pod 中的所有容器均已准备就绪。</li>
<li><code>ReadinessGates</code> 中指定的所有条件均为 <code>True</code>。</li>
</ul>
<p>当 Pod 的容器准备就绪但至少一个自定义条件是缺失的或 <code>False</code> 时，kubelet 将 Pod 的条件设置为 <code>ContainersReady</code>。</p>
<h2 id="重启策略">重启策略</h2>
<p>PodSpec 中有一个 <code>restartPolicy</code> 字段，可能的值为 Always、OnFailure 和 Never。默认为 Always。 <code>restartPolicy</code> 适用于 Pod 中的所有容器。<code>restartPolicy</code> 仅指通过同一节点上的 kubelet 重新启动容器。失败的容器由 kubelet 以五分钟为上限的指数退避延迟（10秒，20秒，40秒&hellip;）重新启动，并在成功执行十分钟后重置。如 <a href="https://kubernetes.io/docs/user-guide/pods/#durability-of-pods-or-lack-thereof">Pod 文档</a> 中所述，一旦绑定到一个节点，Pod 将永远不会重新绑定到另一个节点。</p>
<h2 id="pod-的生命">Pod 的生命</h2>
<p>一般来说，Pod 会一直保留，直到人为或 <a href="https://kubernetes.io/docs/concepts/architecture/controller/">控制器</a> 进程明确地销毁他们。当 Pod 的数量超过配置的阈值（取决于 kube-controller-manager 中的 <code>terminate-pod-gc-threshold</code>）时，控制平面将清理终止的 Pod（阶段为成功或失败）。这样可以避免在创建和终止 Pod 时资源泄漏。</p>
<p>有多种创建Pod的资源：</p>
<ul>
<li>对不希望终止的 Pod 使用 <a href="https://kubernetes.io/docs/concepts/workloads/controllers/deployment/">Deployment</a>、<a href="https://kubernetes.io/docs/concepts/workloads/controllers/replicaset/">ReplicaSet</a> 或 <a href="https://kubernetes.io/docs/concepts/workloads/controllers/statefulset/">StatefulSet</a>，例如 Web 服务器。</li>
<li>对希望在工作完成后终止的 Pod 使用 <a href="https://kubernetes.io/docs/concepts/jobs/run-to-completion-finite-workloads/">Job</a>，例如批量计算。Job 仅适用于 <code>restartPolicy</code> 为 <code>OnFailure</code> 或 <code>Never</code> 的 Pod。</li>
<li>对需要在每个合格节点上运行一个的 Pod 使用 <a href="https://kubernetes.io/docs/concepts/workloads/controllers/daemonset/">DaemonSet</a>。</li>
</ul>
<p>所有工作负载资源都包含一个 PodSpec。建议创建适当的工作负载资源，并让资源的控制器为您创建Pod，而不是自己直接创建Pods。</p>
<p>如果某个节点死亡或与集群的其余部分断开连接，则 Kubernetes 将应用一个策略将丢失节点上的所有 Pod 的 <code>phase</code> 设置为 Failed。</p>
<h2 id="示例">示例</h2>
<h3 id="高级-liveness-探针示例">高级 liveness 探针示例</h3>
<p>存活探针由 kubelet 来执行，因此所有的请求都在 kubelet 的网络命名空间中进行。</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#a2f;font-weight:bold">apiVersion</span>:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>Pod<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">metadata</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">labels</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">test</span>:<span style="color:#bbb"> </span>liveness<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">name</span>:<span style="color:#bbb"> </span>liveness-http<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">spec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">containers</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>- <span style="color:#a2f;font-weight:bold">args</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>- /server<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">image</span>:<span style="color:#bbb"> </span>k8s.gcr.io/liveness<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">livenessProbe</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">httpGet</span>:<span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#080;font-style:italic"># 当没有定义 &#34;host&#34; 时，使用 &#34;PodIP&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#080;font-style:italic"># host: my-host</span><span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#080;font-style:italic"># 当没有定义 &#34;scheme&#34; 时，使用 &#34;HTTP&#34; scheme 只允许 &#34;HTTP&#34; 和 &#34;HTTPS&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#080;font-style:italic"># scheme: HTTPS</span><span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#a2f;font-weight:bold">path</span>:<span style="color:#bbb"> </span>/healthz<span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#a2f;font-weight:bold">port</span>:<span style="color:#bbb"> </span><span style="color:#666">8080</span><span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#a2f;font-weight:bold">httpHeaders</span>:<span style="color:#bbb">
</span><span style="color:#bbb">        </span>- <span style="color:#a2f;font-weight:bold">name</span>:<span style="color:#bbb"> </span>X-Custom-Header<span style="color:#bbb">
</span><span style="color:#bbb">          </span><span style="color:#a2f;font-weight:bold">value</span>:<span style="color:#bbb"> </span>Awesome<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">initialDelaySeconds</span>:<span style="color:#bbb"> </span><span style="color:#666">15</span><span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">timeoutSeconds</span>:<span style="color:#bbb"> </span><span style="color:#666">1</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">name</span>:<span style="color:#bbb"> </span>liveness<span style="color:#bbb">
</span></code></pre></div><h3 id="状态示例">状态示例</h3>
<ul>
<li>
<p>Pod 中只有一个容器并且正在运行。容器成功退出。</p>
<ul>
<li>
<p>记录完成事件。</p>
</li>
<li>
<p>如果 <code>restartPolicy</code> 为：</p>
<ul>
<li>Always：重启容器；Pod <code>phase</code> 仍为 Running。</li>
</ul>
</li>
</ul>
</li>
<li>
<p>OnFailure：Pod <code>phase</code> 变成 Succeeded。</p>
<ul>
<li>Never：Pod <code>phase</code> 变成 Succeeded。</li>
</ul>
</li>
<li>
<p>Pod 中只有一个容器并且正在运行。容器退出失败。</p>
<ul>
<li>
<p>记录失败事件。</p>
</li>
<li>
<p>如果 <code>restartPolicy</code> 为：</p>
<ul>
<li>Always：重启容器；Pod <code>phase</code> 仍为 Running。</li>
</ul>
</li>
</ul>
</li>
<li>
<p>OnFailure：重启容器；Pod <code>phase</code> 仍为 Running。</p>
<ul>
<li>Never：Pod <code>phase</code> 变成 Failed。</li>
</ul>
</li>
<li>
<p>Pod 中有两个容器并且正在运行。容器 1 退出失败。</p>
<ul>
<li>
<p>记录失败事件。</p>
</li>
<li>
<p>如果 <code>restartPolicy</code> 为：</p>
<ul>
<li>Always：重启容器；Pod <code>phase</code> 仍为 Running。</li>
<li>OnFailure：重启容器；Pod <code>phase</code> 仍为 Running。</li>
<li>Never：不重启容器；Pod <code>phase</code> 仍为 Running。</li>
</ul>
</li>
<li>
<p>如果容器 1 没有处于运行状态，并且容器 2 退出：</p>
<ul>
<li>
<p>记录失败事件。</p>
</li>
<li>
<p>如果 <code>restartPolicy</code> 为：</p>
<ul>
<li>Always：重启容器；Pod <code>phase</code> 仍为 Running。</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>OnFailure：重启容器；Pod <code>phase</code> 仍为 Running。
- Never：Pod <code>phase</code> 变成 Failed。</p>
</li>
<li>
<p>Pod 中只有一个容器并处于运行状态。容器运行时内存超出限制：</p>
<ul>
<li>
<p>容器以失败状态终止。</p>
</li>
<li>
<p>记录 OOM 事件。</p>
</li>
<li>
<p>如果 <code>restartPolicy</code> 为：</p>
<ul>
<li>Always：重启容器；Pod <code>phase</code> 仍为 Running。</li>
</ul>
</li>
</ul>
</li>
<li>
<p>OnFailure：重启容器；Pod <code>phase</code> 仍为 Running。</p>
<ul>
<li>Never: 记录失败事件；Pod <code>phase</code> 变成 Failed。</li>
</ul>
</li>
<li>
<p>Pod 正在运行，磁盘故障：</p>
<ul>
<li>杀掉所有容器。</li>
<li>记录适当事件。</li>
<li>Pod <code>phase</code> 变成 Failed。</li>
<li>如果使用控制器来运行，Pod 将在别处重建。</li>
</ul>
</li>
<li>
<p>Pod 正在运行，其节点分段退出。</p>
<ul>
<li>节点控制器等待直到超时。</li>
<li>节点控制器将 Pod <code>phase</code> 设置为 Failed。</li>
<li>如果是用控制器来运行，Pod 将在别处重建。</li>
</ul>
</li>
</ul>

	
	
	<div class="text-muted mt-5 pt-3 border-top">最后修改 2020-07-23 16:43PM Thu
</div>
</div>


          </main>
        </div>
      </div>
      
<footer class="bg-dark py-5 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="User mailing list" aria-label="User mailing list">
    <a class="text-white" target="_blank" href="https://github.com/luohu1">
      <i class="fa fa-envelope"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="GitHub" aria-label="GitHub">
    <a class="text-white" target="_blank" href="https://github.com/luohu1">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-12 col-sm-4 text-center py-2 order-sm-2">
        <small class="text-white">&copy; 2020 LH All Rights Reserved</small>
        
	
		<p class="mt-2"><a href="/about/">About</a></p>
	
      </div>
    </div>
  </div>
</footer>


    </div>
    
<script src="/js/popper-1.14.3.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="/js/bootstrap-4.1.3.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>









<script src="/js/main.min.b6dfd66b2d261380250c517fd39bc9d8659709e9fc924b00d8fed92e8d9df768.js" integrity="sha256-tt/Way0mE4AlDFF/05vJ2GWXCen8kksA2P7ZLo2d92g=" crossorigin="anonymous"></script>



  </body>
</html>